<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">任务与配置</h1>
</div>

<div class="row">
    <div class="col-lg-12">
        <!-- 定时任务管理 -->
        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h3>定时任务管理</h3>
                <button class="btn btn-success btn-sm" onclick="showScheduleModal()">
                    <i class="fas fa-plus me-2"></i>新建任务
                </button>
            </div>
            <div class="card-body">
                <div id="schedulesList">加载中...</div>
            </div>
        </div>

        <!-- 定时任务执行历史 -->
        <div class="card">
            <div class="card-header">
                <h3>定时任务执行历史</h3>
            </div>
            <div class="card-body">
                <ul class="list-group" id="schedule-history-list">
                    <!-- 定时任务历史将在这里动态生成 -->
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- 模态框容器 -->
<div id="modal-container">
    <!-- 定时任务模态框 -->
    <div class="modal fade" id="scheduleModal" tabindex="-1" aria-labelledby="scheduleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="scheduleModalLabel">管理定时任务</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="scheduleForm">
                        <input type="hidden" id="scheduleId">
                        <div class="mb-3">
                            <label for="scheduleName" class="form-label">任务名称</label>
                            <input type="text" class="form-control" id="scheduleName" required>
                        </div>
                        <div class="mb-3">
                            <label for="scheduleTaskType" class="form-label">任务类型</label>
                            <select class="form-select" id="scheduleTaskType" required>
                                <option value="fetch_inventory">库存查询</option>
                                <option value="run_analysis">预警分析</option>
                                <option value="check_orders">订单查询</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="scheduleCron" class="form-label">Cron 表达式</label>
                            <input type="text" class="form-control" id="scheduleCron" placeholder="例如: 0 2 * * *" required>
                            <div class="form-text">
                                使用标准 Cron 格式。例如 <code>0 2 * * *</code> 表示每天凌晨2点执行。
                            </div>
                        </div>
                        <div class="form-check form-switch mb-3">
                            <input class="form-check-input" type="checkbox" id="scheduleActive" checked>
                            <label class="form-check-label" for="scheduleActive">启用任务</label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" onclick="saveSchedule()">保存任务</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Schedule History Modal -->
    <div class="modal fade" id="scheduleHistoryModal" tabindex="-1" aria-labelledby="scheduleHistoryModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="scheduleHistoryModalLabel">任务执行历史</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="scheduleHistoryBody">
                    <!-- History content will be loaded here -->
                </div>
            </div>
        </div>
    </div>
</div>
